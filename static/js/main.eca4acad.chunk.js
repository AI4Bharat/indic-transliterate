(this["webpackJsonpreact-transliterate-example"]=this["webpackJsonpreact-transliterate-example"]||[]).push([[0],{18:function(e,t,n){"use strict";n.r(t);n(9);var a=n(0),r=n(5),o=n.n(r),s=n(1),i=n(6),l=n.n(i);const c={KEY_RETURN:"Enter",KEY_ENTER:"Enter",KEY_TAB:"Tab",KEY_SPACE:" "},u="transliterateCache",d=function(){const e=localStorage.getItem(u);return e?JSON.parse(e):{}}();let g=0;function h(){localStorage.setItem(u,JSON.stringify(d))}window.addEventListener("beforeunload",h);const p="https://xlit-api.ai4bharat.org/tl/",f=async()=>{if(sessionStorage.getItem("indic_transliterate__supported_languages"))return JSON.parse(sessionStorage.getItem("indic_transliterate__supported_languages")||"");{const t="".concat("https://xlit-api.ai4bharat.org/","languages");(new Headers).append("Content-Type","application/json");const n={method:"GET"};try{const e=await fetch(t,n),a=await e.json();return sessionStorage.setItem("indic_transliterate__supported_languages",JSON.stringify(a)),a}catch(e){return console.error("There was an error with transliteration",e),[]}}},b=e=>{let{renderComponent:t=e=>Object(s.jsx)("input",{...e}),lang:n="hi",offsetX:r=0,offsetY:o=10,onChange:i,onChangeText:u,onBlur:b,value:j,onKeyDown:m,containerClassName:w="",containerStyles:O={},activeItemStyles:x={},maxOptions:S=5,hideSuggestionBoxOnMobileDevices:v=!1,hideSuggestionBoxBreakpoint:y=450,triggerKeys:C=[c.KEY_SPACE,c.KEY_ENTER,c.KEY_RETURN,c.KEY_TAB],insertCurrentSelectionOnBlur:E=!0,showCurrentWordAsLastSuggestion:k=!0,enabled:_=!0,horizontalView:T=!1,customApiURL:I=p,...N}=e;const[L,A]=Object(a.useState)(0),[R,D]=Object(a.useState)(0),[B,K]=Object(a.useState)(0),[M,U]=Object(a.useState)(-1),[Y,F]=Object(a.useState)(-1),W=Object(a.useRef)(null),[J,q]=Object(a.useState)({width:0,height:0}),[z,P]=Object(a.useState)("ltr"),[G,H]=Object(a.useState)(null),[V,X]=Object(a.useState)([]),[Q,Z]=Object(a.useState)([]),[$,ee]=Object(a.useState)(0),[te,ne]=Object(a.useState)("0"),[ae,re]=Object(a.useState)(Math.random().toString(36).substr(2,9)),[oe,se]=Object(a.useState)(0),[ie,le]=Object(a.useState)(!0),ce=Object(a.useMemo)((()=>!v||J.width>y),[J,y,v]),ue=()=>{K(0),X([])},de=e=>{var t;const a=j,r=a.substring(0,M)+V[e]+" "+a.substring(Y+1,a.length);if(Q.length){let t=Q[Q.length-1],a={keystrokes:t.keystrokes,results:t.results,opted:V[e],created_at:(new Date).toISOString(),language:n};Z([...Q,a]),ee($+1)}setTimeout((()=>{var t,n;t=W.current,n=M+V[e].length+1,t&&(t.selectionStart?(t.focus(),t.setSelectionRange(n,n)):t.focus())}),1);const o={target:{value:r}};return u(r),i&&i(o),ue(),null===(t=W.current)||void 0===t?void 0:t.focus()},ge=async(e,t)=>{if(!ce)return;const a=await(async(e,t,n)=>{const{showCurrentWordAsLastSuggestion:a=!0,lang:r="hi"}=n||{};if(d[r]||(d[r]={}),d[r][e.toLowerCase()])return d[r][e.toLowerCase()].frequency+=1,d[r][e.toLowerCase()].suggestions;const o={method:"GET"};try{const n=await fetch(t+"".concat(r,"/").concat("."===e||".."===e?" "+e.replace(".","%2E"):encodeURIComponent(e).replace(".","%2E")),o);let s=await n.json();if(console.log("library data",s),t.includes("xlit-api")||(s.result=s.output[0].target),s&&s.result.length>0){const t=a?[...s.result,e]:s.result;if(Object.keys(d[r]).length>=1e4){const e=(e=>{let t=null,n=1/0;for(const a in e)e[a].frequency<n&&(n=e[a].frequency,t=a);return t})(d[r]);e&&delete d[r][e]}return d[r][e.toLowerCase()]={suggestions:t,frequency:1},g+=1,g>=20&&(h(),g=0),t}if(a){const t=[e];return d[r][e.toLowerCase()]={suggestions:t,frequency:1},t}return[]}catch(s){return console.error("There was an error with transliteration",s),[]}})(e,I,{showCurrentWordAsLastSuggestion:k,lang:n});X(null!==a&&void 0!==a?a:[]);let r={keystrokes:t,results:a,opted:"",created_at:(new Date).toISOString(),language:n};ie?(le(!1),Z([r])):Z([...Q,r])},he=()=>{const e=window.innerWidth,t=window.innerHeight;q({width:e,height:t})};return Object(a.useEffect)((()=>{window.addEventListener("resize",he);const e=window.innerWidth,t=window.innerHeight;return q({width:e,height:t}),()=>{window.removeEventListener("resize",he)}}),[]),Object(a.useEffect)((()=>{(async e=>{const t=await f(),n=null===t||void 0===t?void 0:t.find((t=>t.LangCode===e));var a;return[null!==(a=null===n||void 0===n?void 0:n.Direction)&&void 0!==a?a:"ltr",null===n||void 0===n?void 0:n.GoogleFont,null===n||void 0===n?void 0:n.FallbackFont]})(n).then((e=>{let[t,n,a]=e;if(P(t),n){if(!document.getElementById("font-".concat(n))){const e=document.createElement("link");e.id="font-".concat(n),e.href="https://fonts.googleapis.com/css?family=".concat(n),e.rel="stylesheet",document.head.appendChild(e)}H("".concat(n,", ").concat(null!==a&&void 0!==a?a:"sans-serif"))}else H(null)}))}),[n]),Object(s.jsxs)("div",{style:{...O,position:"relative"},className:w,children:[t({onChange:e=>{const t=e.currentTarget.value;if((0==$||ie)&&(t.length>=4?se(t.length-4):se(0)),$>=5){const e={uuid:ae,parent_uuid:te,word:t,source:void 0!=localStorage.getItem("source")?localStorage.getItem("source"):"node-module",language:n,steps:Q};Z([]),ne(ae),re(Math.random().toString(36).substr(2,9)),se(t.length-2),ee(0),le(!0),fetch("https://backend.shoonya.ai4bharat.org/logs/transliteration_selection/",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((async e=>{if(!e.ok)throw await e.json()})).catch((e=>{console.log("error",e)}))}if(i&&i(e),u(t),!ce)return;const a=(r=e.target,r&&"number"===typeof r.selectionStart&&"number"===typeof r.selectionEnd?{start:r.selectionStart,end:r.selectionEnd}:{start:0,end:0}).end;var r;const o=W.current;if(!o)return;const s=l()(o,a),c=t.lastIndexOf(" ",a-1)<t.lastIndexOf("\n",a-1)?t.lastIndexOf("\n",a-1):t.lastIndexOf(" ",a-1);U(c+1),F(a-1);const d=t.slice(c+1,a);if(d&&_){0==$||ie?t.length>=4?ge(d,t.substr(t.length-4,t.length)):ge(d,t.substr(0,t.length)):ge(d,t.substr(oe,t.length));const e=o.getBoundingClientRect(),n=Math.min(s.left,e.width-50),a=Math.min(s.top+10,e.height);D(a),A(n)}else ue()},onKeyDown:e=>{if(V.length>0)if(C.includes(e.key))e.preventDefault(),de(B);else switch(e.key){case"Escape":e.preventDefault(),ue();break;case"ArrowUp":case"ArrowLeft":e.preventDefault(),K((V.length+B-1)%V.length);break;case"ArrowDown":case"ArrowRight":e.preventDefault(),K((B+1)%V.length);break;default:m&&m(e)}else m&&m(e)},onBlur:e=>{"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||(E&&V[B]?de(B):ue()),b&&b(e)},ref:W,value:j,"data-testid":"rt-input-component",lang:n,style:{direction:z,...G&&{fontFamily:G}},...N}),ce&&V.length>0&&Object(s.jsx)("ul",{style:{backgroundClip:"padding-box",backgroundColor:"#fff",border:"1px solid rgba(0, 0, 0, 0.15)",boxShadow:"0 6px 12px rgba(0, 0, 0, 0.175)",display:T?"flex":"block",fontSize:"14px",listStyle:"none",padding:"1px",textAlign:"center",zIndex:2e4,left:"".concat(L+r,"px"),top:"".concat(R+o,"px"),position:"absolute",width:"auto",...G&&{fontFamily:G}},"data-testid":"rt-suggestions-list",lang:n,children:Array.from(new Set(V)).map(((e,t)=>Object(s.jsx)("li",{style:t===B?{cursor:"pointer",padding:"10px",minWidth:"100px",backgroundColor:"#65c3d7",color:"#fff"}:{cursor:"pointer",padding:"10px",minWidth:"100px",backgroundColor:"#fff"},onMouseEnter:()=>{K(t)},onClick:()=>de(t),children:e},e)))})]})};var j=n(33);var m=()=>{const[e,t]=Object(a.useState)(""),[n,r]=Object(a.useState)(),[o,i]=Object(a.useState)("hi");return Object(a.useEffect)((()=>{f().then((e=>r(e)))}),[]),Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("h2",{children:"Indic transliterate"}),Object(s.jsx)("select",{className:"language-dropdown",value:o,onChange:e=>i(e.target.value),children:null===n||void 0===n?void 0:n.map((e=>Object(s.jsx)("option",{value:e.LangCode,children:e.DisplayName},e.LangCode)))}),Object(s.jsx)("div",{className:"spacer"}),Object(s.jsx)("label",{htmlFor:"react-transliterate-input",children:"Using input"}),Object(s.jsx)(b,{value:e,onChangeText:e=>{t(e)},lang:o,placeholder:"Start typing here...",id:"react-transliterate-input"}),Object(s.jsx)("div",{className:"spacer"}),Object(s.jsx)("label",{htmlFor:"react-transliterate-textarea",children:"Using textarea"}),Object(s.jsx)(b,{renderComponent:e=>Object(s.jsx)("textarea",{...e}),value:e,onChangeText:e=>{t(e)},lang:o,placeholder:"Start typing here...",id:"react-transliterate-textarea"}),Object(s.jsx)("div",{className:"spacer"}),Object(s.jsx)("label",{htmlFor:"react-transliterate-material-ui-input",children:"Using Material UI input"}),Object(s.jsx)(b,{renderComponent:e=>{const t=e.ref;return delete e.ref,Object(s.jsx)(j.a,{fullWidth:!0,...e,inputRef:t})},value:e,onChangeText:e=>{t(e)},lang:o,placeholder:"Start typing here...",id:"react-transliterate-material-ui-input"})]})};o.a.render(Object(s.jsx)(m,{}),document.getElementById("root"))},9:function(e,t,n){}},[[18,1,2]]]);
//# sourceMappingURL=main.eca4acad.chunk.js.map